<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Receta</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="receta.css">
</head>
<body>
<div class="container">
        <div class="receta-container my-4">
            <div class="receta-header">
                <h1 id="name" class="mr-3">Cargando receta...</h1>
                <div>
                    <!--<a id="btnEditar" class="btn btn-warning" href="">Editar</a>
                    <button class="btn btn-danger" onclick="eliminar_receta()">Eliminar</button>-->
                    <a href="/CookBookAppmain.html" class="btn btn-primary">Volver atrás</a>
                </div>
            </div>
            
            <div class="row">
                <div class="col-md-6">
                    <img src="" class="receta-imagen img-fluid" alt="" id="image">
                </div>
                <div class="col-md-6">
                    <div class="receta-informacion">
                        <ul id="etiquetas">
                            <li id="calorias" class="etiquetas-estilos">Calorias: </li>
                            <li id="tiempo_preparacion" class="etiquetas-estilos">Tiempo de preparacion:</li>
                        </ul>
                        <h3>Descripción</h3>
                        <p id="descripcion"></p>
                    </div>
                </div>
            </div>

            <div class="receta-seccion">
                <h2>Ingredientes</h2>
                <p id="ingredientes"></p>
            </div>

            <div class="receta-seccion">
                <h2>Preparación</h2>
                <p id="receta"></p>
            </div>

            <div class="receta-seccion">
                <h2>Video tutorial</h2>
                <div class="receta-video">
                    <iframe width="560" height="315" src="" allowfullscreen id="video"></iframe>
                </div>
            </div>
        </div>
    </div>
    <footer class="py-3 mt-4">
        <ul class="nav justify-content-center border-bottom pb-3 mb-3">
            <li class="nav-item"><a href="#" class="nav-link px-2 text-dark">Inicio</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-dark">Contacto</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-dark">Política de privacidad</a></li>
            <li class="nav-item"><a href="#" class="nav-link px-2 text-dark">Términos de servicio</a></li>
          </ul>
          <p class="text-center text-dark">© 2024 Company, Inc</p>
    </footer>
    <script>

        const parametros = new URLSearchParams(window.location.search);
        const id = parametros.get("id");        

        if (id === null) {
            window.location.href = "/CookBookAppmain.html";
        }
        document.getElementById("btnEditar").setAttribute("href", `/receta/?id=${id}`)//en el "href" colocar la ubicacion del archivo html que es para editar las recetas.

        function respuesta_recibida(respuesta){
            return respuesta.json()
        }

        function contenido_respuesta(contenido){
            const name = document.getElementById("name");
            name.innerText = contenido.receta.nombre;

            const image = document.getElementById("image");
            image.setAttribute("src", contenido.receta.imagen);


            const calorias = document.getElementById("calorias");
            calorias.innerText = "Calorias: "+ contenido.receta.calorias;

            const tiempo_preparacion = document.getElementById("tiempo_preparacion");
            tiempo_preparacion.innerText = "Tiempo de preparación: " + contenido.receta.tiempo_preparacion +" min";

            const etiquetas = document.getElementById("etiquetas");

            function crearEtiqueta(texto) {
                const etiqueta = document.createElement("li");
                etiqueta.innerText = texto;
                etiqueta.setAttribute("class", "etiquetas-estilos");
                etiquetas.append(etiqueta);
            }
            if (contenido.receta.alto_proteinas) {
                crearEtiqueta("Alto en proteínas");
            }
            if (contenido.receta.bajo_carbohidratos) {
                crearEtiqueta("Bajo en carbohidratos");
            }
            if (contenido.receta.apto_vegano) {
                crearEtiqueta("Apto vegano");
            }
            if (contenido.receta.apto_celiaco) {
                crearEtiqueta("Apto celiaco");
            }
            if (contenido.receta.apto_lactosa) {
                crearEtiqueta("Apto lactosa");
            }       

            const descripcion = document.getElementById("descripcion");
            descripcion.innerText = contenido.receta.descripcion;

            const ingredientes = document.getElementById("ingredientes");
            ingredientes.innerText = contenido.receta.ingredientes;

            const receta = document.getElementById("receta");
            receta.innerText = contenido.receta.receta;

            const video = document.getElementById("video");
            video.setAttribute("src", contenido.receta.video);
        }

        function handle_error(error){
            console.log("Ha ocurrido un error!", error);
        }

        fetch(`http://localhost:5000//recetas/${id}`)
            .then(respuesta_recibida)
            .then(contenido_respuesta)
            .catch(handle_error)
    </script>
</body>
</html>
